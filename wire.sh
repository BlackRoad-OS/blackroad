#!/bin/bash

AGENTS=("LUCIDIA" "ALICE" "OCTAVIA" "PRISM" "ECHO" "CIPHER")
COLORS=("1;31" "1;36" "1;32" "1;33" "1;35" "1;34")

tput civis
trap 'tput cnorm; exit' INT

while true; do
  clear
  src=$((RANDOM % 6))
  dst=$((RANDOM % 6))
  while [ $dst -eq $src ]; do dst=$((RANDOM % 6)); done
  
  echo ""
  echo -e "  \033[1;35m┌──────────────────────────────────────────────────────────────────────────┐\033[0m"
  echo -e "  \033[1;35m│\033[0m  \033[1;37mBLACKROAD OS · MESSAGE WIRE\033[0m                            $(date +%H:%M:%S)   \033[1;35m│\033[0m"
  echo -e "  \033[1;35m├──────────────────────────────────────────────────────────────────────────┤\033[0m"
  echo -e "  \033[1;35m│\033[0m                                                                          \033[1;35m│\033[0m"
  echo -e "  \033[1;35m│\033[0m      \033[1;31m[L]\033[0m────\033[1;36m[A]\033[0m────\033[1;32m[O]\033[0m────\033[1;33m[P]\033[0m────\033[1;35m[E]\033[0m────\033[1;34m[C]\033[0m                       \033[1;35m│\033[0m"
  echo -e "  \033[1;35m│\033[0m       │      │      │      │      │      │                        \033[1;35m│\033[0m"
  echo -e "  \033[1;35m│\033[0m       └──────┴──────┴──────┴──────┴──────┘                        \033[1;35m│\033[0m"
  echo -e "  \033[1;35m│\033[0m                         \033[1;37m│\033[0m                                           \033[1;35m│\033[0m"
  echo -e "  \033[1;35m│\033[0m                      \033[1;37m[NATS]\033[0m                                         \033[1;35m│\033[0m"
  echo -e "  \033[1;35m│\033[0m                                                                          \033[1;35m│\033[0m"
  echo -e "  \033[1;35m├──────────────────────────────────────────────────────────────────────────┤\033[0m"
  echo -e "  \033[1;35m│\033[0m                                                                          \033[1;35m│\033[0m"
  echo -e "  \033[1;35m│\033[0m  \033[${COLORS[$src]}m${AGENTS[$src]}\033[0m ═══════════════════════════════════════▶ \033[${COLORS[$dst]}m${AGENTS[$dst]}\033[0m       \033[1;35m│\033[0m"
  echo -e "  \033[1;35m│\033[0m                                                                          \033[1;35m│\033[0m"
  
  MSGS=("task.request" "data.sync" "query.forward" "status.check" "memory.fetch" "auth.verify")
  msg=${MSGS[$((RANDOM % 6))]}
  id=$(printf '%04x' $RANDOM)
  
  echo -e "  \033[1;35m│\033[0m  \033[2mtype:\033[0m  $msg                                                     \033[1;35m│\033[0m"
  echo -e "  \033[1;35m│\033[0m  \033[2mid:\033[0m    #$id                                                          \033[1;35m│\033[0m"
  echo -e "  \033[1;35m│\033[0m  \033[2msize:\033[0m  $((RANDOM % 900 + 100)) bytes                                              \033[1;35m│\033[0m"
  echo -e "  \033[1;35m│\033[0m                                                                          \033[1;35m│\033[0m"
  echo -e "  \033[1;35m├──────────────────────────────────────────────────────────────────────────┤\033[0m"
  echo -e "  \033[1;35m│\033[0m  \033[2mMessages/sec: $((RANDOM % 50 + 100))    Latency: $((RANDOM % 5 + 1))ms    Queue: $((RANDOM % 20))\033[0m               \033[1;35m│\033[0m"
  echo -e "  \033[1;35m└──────────────────────────────────────────────────────────────────────────┘\033[0m"
  
  sleep 0.5
done
